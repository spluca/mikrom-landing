---
/**
 * RoadmapTimeline - Product roadmap display section
 *
 * @description
 * Displays product roadmap items organized by quarter with status indicators.
 * Shows planned, in-progress, and completed features.
 *
 * @example Basic usage
 * ```astro
 * <RoadmapTimeline
 *   quarters={[
 *     {
 *       quarter: "Q1 2025",
 *       status: "in-progress",
 *       items: [
 *         { title: "Feature A", description: "...", status: "completed" },
 *         { title: "Feature B", description: "...", status: "in-progress" },
 *       ]
 *     }
 *   ]}
 * />
 * ```
 */

type RoadmapStatus = 'completed' | 'in-progress' | 'planned' | 'exploring';

interface RoadmapItem {
  /** Feature title */
  title: string;
  /** Feature description */
  description: string;
  /** Item status */
  status: RoadmapStatus;
}

interface RoadmapQuarter {
  /** Quarter label (e.g., "Q1 2025") */
  quarter: string;
  /** Overall quarter status */
  status: RoadmapStatus;
  /** Items in this quarter */
  items: RoadmapItem[];
}

interface Props {
  /** Array of quarters with roadmap items */
  quarters: RoadmapQuarter[];
  /** Section background style */
  background?: 'default' | 'muted' | 'accent';
}

const { quarters, background = 'default' } = Astro.props;

const bgClass = {
  default: 'bg-background',
  muted: 'bg-surface',
  accent: 'bg-primary/5',
}[background];

const statusColors: Record<RoadmapStatus, string> = {
  completed: 'bg-green-500/10 text-green-600 dark:text-green-400',
  'in-progress': 'bg-primary/10 text-primary',
  planned: 'bg-text-muted/10 text-text-muted',
  exploring: 'bg-secondary/10 text-secondary',
};

const statusLabels: Record<RoadmapStatus, string> = {
  completed: 'Completed',
  'in-progress': 'In Progress',
  planned: 'Planned',
  exploring: 'Exploring',
};
---

<section class:list={['py-section', bgClass]}>
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Status Legend -->
    <div class="flex flex-wrap gap-4 justify-center mb-12">
      {
        Object.entries(statusLabels).map(([key, label]) => (
          <div class="flex items-center gap-2">
            <span
              class:list={[
                'w-3 h-3 rounded-full',
                statusColors[key as RoadmapStatus].split(' ')[0],
              ]}
            />
            <span class="text-sm text-text-muted">{label}</span>
          </div>
        ))
      }
    </div>

    <!-- Timeline -->
    <div class="space-y-12">
      {
        quarters.map((quarter) => (
          <div>
            <h2 class="text-xl font-bold text-text mb-6 flex items-center gap-3">
              {quarter.quarter}
              <span
                class:list={[
                  'px-2.5 py-0.5 text-xs font-medium rounded-full',
                  statusColors[quarter.status],
                ]}
              >
                {statusLabels[quarter.status]}
              </span>
            </h2>

            <div class="space-y-4">
              {quarter.items.map((item) => (
                <div class="p-6 rounded-lg border border-border bg-surface/50">
                  <div class="flex items-start justify-between gap-4">
                    <div>
                      <h3 class="text-lg font-semibold text-text">{item.title}</h3>
                      <p class="mt-2 text-text-muted">{item.description}</p>
                    </div>
                    <span
                      class:list={[
                        'shrink-0 px-2.5 py-0.5 text-xs font-medium rounded-full',
                        statusColors[item.status],
                      ]}
                    >
                      {statusLabels[item.status]}
                    </span>
                  </div>
                </div>
              ))}
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>
