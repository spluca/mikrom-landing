---
/**
 * TeamSection - Team members grid display
 *
 * @description
 * Displays team members in a responsive grid with avatars, names,
 * roles, and optional bios. Supports avatar fallback with initials.
 *
 * @example Basic usage
 * ```astro
 * <TeamSection
 *   title="Meet the team"
 *   members={[
 *     { name: "Jane Doe", role: "CEO", avatar: "/images/team/jane.jpg" },
 *     { name: "John Smith", role: "CTO", bio: "..." },
 *   ]}
 * />
 * ```
 */

interface TeamMember {
  /** Member's full name */
  name: string;
  /** Job title or role */
  role: string;
  /** Optional bio/description */
  bio?: string;
  /** Avatar image URL */
  avatar?: string;
  /** Optional social links */
  social?: {
    twitter?: string;
    linkedin?: string;
    github?: string;
  };
}

interface Props {
  /** Optional section title */
  title?: string;
  /** Optional section subtitle */
  subtitle?: string;
  /** Array of team members */
  members: TeamMember[];
  /** Number of columns */
  columns?: 2 | 3 | 4;
  /** Section background style */
  background?: 'default' | 'muted' | 'accent';
}

const { title, subtitle, members, columns = 4, background = 'muted' } = Astro.props;

const bgClass = {
  default: 'bg-background',
  muted: 'bg-surface',
  accent: 'bg-primary/5',
}[background];

const columnClass = {
  2: 'grid-cols-1 sm:grid-cols-2',
  3: 'grid-cols-1 sm:grid-cols-2 lg:grid-cols-3',
  4: 'grid-cols-1 sm:grid-cols-2 lg:grid-cols-4',
}[columns];

const hasHeading = title || subtitle;

// Generate initials from name
const getInitials = (name: string) =>
  name
    .split(' ')
    .map((n) => n[0])
    .join('')
    .toUpperCase()
    .slice(0, 2);
---

<section class:list={['py-section', bgClass]}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    {
      hasHeading && (
        <div class="mb-12">
          {title && <h2 class="text-2xl sm:text-3xl font-bold text-text">{title}</h2>}
          {subtitle && <p class="mt-4 text-lg text-text-muted">{subtitle}</p>}
        </div>
      )
    }

    <div class:list={['grid gap-8', columnClass]}>
      {
        members.map((member) => (
          <div class="text-center">
            {member.avatar ? (
              <img
                src={member.avatar}
                alt={member.name}
                class="w-24 h-24 mx-auto rounded-full object-cover"
                loading="lazy"
              />
            ) : (
              <div class="w-24 h-24 mx-auto rounded-full bg-primary/10 text-primary flex items-center justify-center text-2xl font-semibold">
                {getInitials(member.name)}
              </div>
            )}
            <h3 class="mt-4 text-lg font-semibold text-text">{member.name}</h3>
            <p class="text-sm text-primary">{member.role}</p>
            {member.bio && <p class="mt-3 text-sm text-text-muted">{member.bio}</p>}
          </div>
        ))
      }
    </div>
  </div>
</section>
